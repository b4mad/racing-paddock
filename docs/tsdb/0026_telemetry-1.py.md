# Generated by Django 5.0.6 on 2024-05-20 11:30

from django.db import migrations, models


def create_hypertable(apps, schema_editor):
    # Get the database connection
    connection = schema_editor.connection
    # Create the hypertable
    with connection.cursor() as cursor:
        cursor.execute(
            """
            SELECT create_hypertable('telemetry_telemetry', 'time');
        """
        )


class Migration(migrations.Migration):

    dependencies = [
        ("telemetry", "0025_alter_coach_mode"),
    ]

    operations = [
        migrations.CreateModel(
            name="Telemetry",
            fields=[
                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name="ID")),
                ("time", models.DateTimeField()),
                ("session_id", models.PositiveIntegerField()),
                ("current_lap", models.PositiveSmallIntegerField()),
                ("current_lap_time", models.FloatField()),
                ("laptime_previous", models.FloatField(null=True)),
                ("clutch", models.FloatField(null=True)),
                ("brake", models.FloatField(null=True)),
                ("throttle", models.FloatField(null=True)),
                ("handbrake", models.FloatField(null=True)),
                ("gear", models.PositiveSmallIntegerField(null=True)),
            ],
            options={
                "unique_together": {("time", "session_id")},
            },
        ),
        migrations.RunPython(create_hypertable),
    ]
